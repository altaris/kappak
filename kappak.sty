%% The MIT License (MIT)
%% 
%% Copyright (c) 2014 CÃ©dric Ho Thanh
%% 
%% Permission is hereby granted, free of charge, to any person obtaining a copy
%% of this software and associated documentation files (the "Software"), to deal
%% in the Software without restriction, including without limitation the rights
%% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
%% copies of the Software, and to permit persons to whom the Software is
%% furnished to do so, subject to the following conditions:
%% 
%% The above copyright notice and this permission notice shall be included in all
%% copies or substantial portions of the Software.
%% 
%% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
%% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
%% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
%% AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
%% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
%% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
%% SOFTWARE.

%% This is the main file of kappak. It declares globals and includes other files.

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{kappak}[2013/05/01 kappak]
\makeatletter

%% ----------------------------------------
%% Metadatas
%% ----------------------------------------

\def\@kappakVersion{0412}   % Current version of kappak
\def\@usedVersion{0406}     % Default version. 0406 is the version where \@kappakVersion started to be taken into account.
\PackageInfo{kappak-v4}{This is kappak, v\@kappakVersion}

%% ----------------------------------------
%%
%% Internal commands and required packages.
%%
%% ----------------------------------------

\input{kappak-utilities}

%% ----------------------------------------
%%
%% Declaring variables and assigning default values.
%%
%% ----------------------------------------

%% ----------------------------------------
%% core
%% ----------------------------------------

% wheaver kappak should automatically include packages. ifthen will always be included 
\newboolean{@b_core_use_autoPackInclusion}  \setboolean{@b_core_use_autoPackInclusion}  {true}

%% ----------------------------------------
%% extpack
%% ----------------------------------------

\newboolean{@b_extpack_use_stix}			\setboolean{@b_extpack_use_stix}			{false}

\newboolean{@b_extpack_use_tikz}            \setboolean{@b_extpack_use_tikz}            {false}
\newboolean{@b_extpack_tikz_externalize}    \setboolean{@b_extpack_tikz_externalize}    {false}

%% ----------------------------------------
%% maths
%% ----------------------------------------

% arrows definitions
\newboolean{@b_maths_use_arrows}            \setboolean{@b_maths_use_arrows}            {false}
% categories definitions
\newboolean{@b_maths_use_categories}        \setboolean{@b_maths_use_categories}        {false}
% character accent definitions
\newboolean{@b_maths_use_characterAccents}  \setboolean{@b_maths_use_characterAccents}  {false}
% character styles definitions
\newboolean{@b_maths_use_characterStyles}   \setboolean{@b_maths_use_characterStyles}   {false}
% some stuff
\newboolean{@b_maths_use_misc}              \setboolean{@b_maths_use_misc}              {false}
% opertor definitions
\newboolean{@b_maths_use_operators}         \setboolean{@b_maths_use_operators}         {false}
% theorem environment definition
\newboolean{@b_maths_use_theoremEnvs}       \setboolean{@b_maths_use_theoremEnvs}       {false}
% styles inside theorem envs, e.g. italic for theorems, roman for definitions, ...
\newboolean{@b_maths_use_theoremStyles}     \setboolean{@b_maths_use_theoremStyles}     {true}

%% ----------------------------------------
%% misc
%% ----------------------------------------

% some stuff
\newboolean{@b_use_misc}                    \setboolean{@b_use_misc}                    {true}

%% ----------------------------------------
%% variables declarations
%% ----------------------------------------

\def\@bbStyle           {normal}
\def\@bibliographyStyle {plain}
\def\@chapterStyle      {normal}
\def\@fontSet           {normal}
\def\@headerFooterStyle {normal}
\def\@language          {english}
\def\@margins           {normal}
\def\@scriptStyle       {normal}
\def\@titlePageStyle    {normal}
\def\@categoryStyle     {script}

%% ----------------------------------------
%%
%% Arguments processing
%%
%% ----------------------------------------

\input{kappak-arguments.tex}

%% ----------------------------------------
%%
%% Commands
%%
%% ----------------------------------------

%% ----------------------------------------
%% Math
%% ----------------------------------------

\input{kappak-maths.tex}

%% ----------------------------------------
%% Other / handy
%% ----------------------------------------

\ifthenelse{\boolean{@b_use_misc}}{

    % Prevents annoying errors upon non printable chars
    % \DeclareUnicodeCharacter{00A0}{ }
    
    % I never remember that thing so here's a command
    \newcommand{\kbibliography}{
		\nocite{*}
		\bibliographystyle{\@bibliographyStyle}
		\bibliography{bibliography}    
    }
    
    \newenvironment{kdocument}{
		\document
	    \maketitle
	    \tableofcontents
	}{
		\kbibliography
	    \enddocument
	}

}{} % \ifthenelse{\boolean{@b_use_misc}}{

%% ----------------------------------------
%% Letter styles
%% ----------------------------------------

\input{kappak-letters.tex}

%% ----------------------------------------
%% tikz
%% ----------------------------------------

\input{kappak-tikz.tex}

%% ----------------------------------------
%%
%% Document styles
%%
%% ----------------------------------------

\input{kappak-styles.tex}

%% ----------------------------------------
%% Environments
%% ----------------------------------------

\input{kappak-environments.tex}

%% ----------------------------------------

\makeatother
\endinput
