%% The MIT License (MIT)
%% 
%% Copyright (c) 2014 CÃ©dric Ho Thanh
%% 
%% Permission is hereby granted, free of charge, to any person obtaining a copy
%% of this software and associated documentation files (the "Software"), to deal
%% in the Software without restriction, including without limitation the rights
%% to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
%% copies of the Software, and to permit persons to whom the Software is
%% furnished to do so, subject to the following conditions:
%% 
%% The above copyright notice and this permission notice shall be included in all
%% copies or substantial portions of the Software.
%% 
%% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
%% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
%% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
%% AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
%% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
%% OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
%% SOFTWARE.

%% Support for tikz

\ProvidesFile{kappak-tikz.tex}[Part of kappak package]

%% ----------------------------------------
%%
%% tikz related commands
%%
%% ----------------------------------------

\ifthenelse{\boolean{@b_extpack_use_tikz}}{

%% --------------------
%% Size
%% --------------------

    \newcommand{\diagramsize}[2]{
        \ifthenelse{\equal{#1}{}}{\def\@tRowsep{3}}{\def\@tRowsep{#1}}
        \ifthenelse{\equal{#2}{}}{\def\@tColsep{4}}{\def\@tColsep{#2}}
    }
    \diagramsize{}{}
    
%% --------------------
%% Styles
%% --------------------

    \newcommand{\diagramarrows}[4]{
        \ifthenelse{\equal{#1}{}}{\def\@diagAA{->}}{}
        \ifthenelse{\equal{#1}{-}}{\def\@diagAA{-}}{}
        \ifthenelse{\equal{#1}{->}}{\def\@diagAA{->}}{}
        \ifthenelse{\equal{#1}{<-}}{\def\@diagAA{<-}}{}
        \ifthenelse{\equal{#1}{<->}}{\def\@diagAA{<->}}{}
        \ifthenelse{\equal{#1}{->>}}{\def\@diagAA{->>}}{}
        \ifthenelse{\equal{#1}{<<-}}{\def\@diagAA{<<-}}{}
        \ifthenelse{\equal{#1}{>->}}{\def\@diagAA{>->}}{}
        \ifthenelse{\equal{#1}{<-<}}{\def\@diagAA{<-<}}{}
        \ifthenelse{\equal{#1}{c->}}{\def\@diagAA{right hook->}}{}
        \ifthenelse{\equal{#1}{<-c}}{\def\@diagAA{<-left hook}}{}
        \ifthenelse{\equal{#1}{|->}}{\def\@diagAA{|->}}{}
        \ifthenelse{\equal{#1}{<-|}}{\def\@diagAA{<-|}}{}
        \ifthenelse{\equal{#2}{}}{\def\@diagAB{->}}{}
        \ifthenelse{\equal{#2}{-}}{\def\@diagAB{-}}{}
        \ifthenelse{\equal{#2}{->}}{\def\@diagAB{->}}{}
        \ifthenelse{\equal{#2}{<-}}{\def\@diagAB{<-}}{}
        \ifthenelse{\equal{#2}{<->}}{\def\@diagAB{<->}}{}
        \ifthenelse{\equal{#2}{->>}}{\def\@diagAB{->>}}{}
        \ifthenelse{\equal{#2}{<<-}}{\def\@diagAB{<<-}}{}
        \ifthenelse{\equal{#2}{>->}}{\def\@diagAB{>->}}{}
        \ifthenelse{\equal{#2}{<-<}}{\def\@diagAB{<-<}}{}
        \ifthenelse{\equal{#2}{c->}}{\def\@diagAB{right hook->}}{}
        \ifthenelse{\equal{#2}{<-c}}{\def\@diagAB{<-left hook}}{}
        \ifthenelse{\equal{#2}{|->}}{\def\@diagAB{|->}}{}
        \ifthenelse{\equal{#2}{<-|}}{\def\@diagAB{<-|}}{}
        \ifthenelse{\equal{#3}{}}{\def\@diagAC{->}}{}
        \ifthenelse{\equal{#3}{-}}{\def\@diagAC{-}}{}
        \ifthenelse{\equal{#3}{->}}{\def\@diagAC{->}}{}
        \ifthenelse{\equal{#3}{<-}}{\def\@diagAC{<-}}{}
        \ifthenelse{\equal{#3}{<->}}{\def\@diagAC{<->}}{}
        \ifthenelse{\equal{#3}{->>}}{\def\@diagAC{->>}}{}
        \ifthenelse{\equal{#3}{<<-}}{\def\@diagAC{<<-}}{}
        \ifthenelse{\equal{#3}{>->}}{\def\@diagAC{>->}}{}
        \ifthenelse{\equal{#3}{<-<}}{\def\@diagAC{<-<}}{}
        \ifthenelse{\equal{#3}{c->}}{\def\@diagAC{right hook->}}{}
        \ifthenelse{\equal{#3}{<-c}}{\def\@diagAC{<-left hook}}{}
        \ifthenelse{\equal{#3}{|->}}{\def\@diagAC{|->}}{}
        \ifthenelse{\equal{#3}{<-|}}{\def\@diagAC{<-|}}{}
        \ifthenelse{\equal{#4}{}}{\def\@diagAD{->}}{}
        \ifthenelse{\equal{#4}{-}}{\def\@diagAD{-}}{}
        \ifthenelse{\equal{#4}{->}}{\def\@diagAD{->}}{}
        \ifthenelse{\equal{#4}{<-}}{\def\@diagAD{<-}}{}
        \ifthenelse{\equal{#4}{<->}}{\def\@diagAD{<->}}{}
        \ifthenelse{\equal{#4}{->>}}{\def\@diagAD{->>}}{}
        \ifthenelse{\equal{#4}{<<-}}{\def\@diagAD{<<-}}{}
        \ifthenelse{\equal{#4}{>->}}{\def\@diagAD{>->}}{}
        \ifthenelse{\equal{#4}{<-<}}{\def\@diagAD{<-<}}{}
        \ifthenelse{\equal{#4}{c->}}{\def\@diagAD{right hook->}}{}
        \ifthenelse{\equal{#4}{<-c}}{\def\@diagAD{<-left hook}}{}
        \ifthenelse{\equal{#4}{|->}}{\def\@diagAD{|->}}{}
        \ifthenelse{\equal{#4}{<-|}}{\def\@diagAD{<-|}}{}
    } % \newcommand{\diagramarrows}[4]{
    
    \newcommand{\diagramlines}[4]{
        \ifthenelse{\equal{#1}{}}{\def\@diagLA{solid}}{}
        \ifthenelse{\equal{#1}{=}}{\def\@diagLA{double}}{}
        \ifthenelse{\equal{#1}{-}}{\def\@diagLA{solid}}{}
        \ifthenelse{\equal{#1}{..}}{\def\@diagLA{dotted}}{}
        \ifthenelse{\equal{#1}{--}}{\def\@diagLA{dashed}}{}
        \ifthenelse{\equal{#2}{}}{\def\@diagLB{solid}}{}
        \ifthenelse{\equal{#2}{=}}{\def\@diagLB{double}}{}
        \ifthenelse{\equal{#2}{-}}{\def\@diagLB{solid}}{}
        \ifthenelse{\equal{#2}{..}}{\def\@diagLB{dotted}}{}
        \ifthenelse{\equal{#2}{--}}{\def\@diagLB{dashed}}{}
        \ifthenelse{\equal{#3}{}}{\def\@diagLC{solid}}{}
        \ifthenelse{\equal{#3}{=}}{\def\@diagLC{double}}{}
        \ifthenelse{\equal{#3}{-}}{\def\@diagLC{solid}}{}
        \ifthenelse{\equal{#3}{..}}{\def\@diagLC{dotted}}{}
        \ifthenelse{\equal{#3}{--}}{\def\@diagLC{dashed}}{}
        \ifthenelse{\equal{#4}{}}{\def\@diagLD{solid}}{}
        \ifthenelse{\equal{#4}{=}}{\def\@diagLD{double}}{}
        \ifthenelse{\equal{#4}{-}}{\def\@diagLD{solid}}{}
        \ifthenelse{\equal{#4}{..}}{\def\@diagLD{dotted}}{}
        \ifthenelse{\equal{#4}{--}}{\def\@diagLD{dashed}}{}
    } % \newcommand{\diagramlines}[4]{

%% --------------------
%% Reset styles
%% --------------------

    \newcommand{\rds}{
        \diagramarrows{}{}{}{}
        \diagramlines{}{}{}{}
    }
    \rds
    
%% --------------------
%% Simple square
%% --------------------

    \newcommand{\squarediagram}[8]{
        \begin{tikzpicture}
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5 ex,
                    text depth = 0.25 ex,
                    ampersand replacement = \&] {
                \displaystyle{#1} \& \displaystyle{#2} \\
                \displaystyle{#3} \& \displaystyle{#4} \\
            };
            \path [\@diagAA] (m-1-1) edge [\@diagLA] node [above] {$#5$} (m-1-2);
            \path [\@diagAB] (m-1-1) edge [\@diagLB] node [left]  {$#6$} (m-2-1);
            \path [\@diagAC] (m-1-2) edge [\@diagLC] node [right] {$#7$} (m-2-2);
            \path [\@diagAD] (m-2-1) edge [\@diagLD] node [above] {$#8$} (m-2-2);
        \end{tikzpicture}
    }
    
%% --------------------
%% Pushout
%% --------------------

    \newcommand{\pushoutdiagram}[8]{
        \begin{tikzpicture}[inline/.style = {fill = white, inner sep = 2.5pt}]
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5 ex,
                    text depth = 0.25 ex,
                    ampersand replacement = \&] {
                \displaystyle{#1} \& \displaystyle{#2} \\
                \displaystyle{#3} \& \displaystyle{#4} \\
            };
            \path (m-1-1) edge [-, draw = white] node [inline] {\mbox{\LARGE{$\ulcorner$}}} (m-2-2);
            \path [\@diagAA] (m-1-1) edge [\@diagLA] node [above] {$#5$} (m-1-2);
            \path [\@diagAB] (m-1-1) edge [\@diagLB] node [left]  {$#6$} (m-2-1);
            \path [\@diagAC] (m-1-2) edge [\@diagLC] node [right] {$#7$} (m-2-2);
            \path [\@diagAD] (m-2-1) edge [\@diagLD] node [above] {$#8$} (m-2-2);
        \end{tikzpicture}
    }
    
%% --------------------
%% Pullback
%% --------------------

    \newcommand{\pullbackdiagram}[8]{
        \begin{tikzpicture}[inline/.style = {fill = white, inner sep = 2.5pt}]
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5 ex,
                    text depth = 0.25ex,
                    ampersand replacement = \&] {
                \displaystyle{#1} \& \displaystyle{#2} \\
                \displaystyle{#3} \& \displaystyle{#4} \\
            };
            \path (m-1-1) edge [-, draw = white] node [inline] {\mbox{\LARGE{$\lrcorner$}}} (m-2-2);
            \path [\@diagAA] (m-1-1) edge [\@diagLA] node [above] {$#5$} (m-1-2);
            \path [\@diagAB] (m-1-1) edge [\@diagLB] node [left]  {$#6$} (m-2-1);
            \path [\@diagAC] (m-1-2) edge [\@diagLC] node [right] {$#7$} (m-2-2);
            \path [\@diagAD] (m-2-1) edge [\@diagLD] node [above] {$#8$} (m-2-2);
        \end{tikzpicture}
    }
    
%% --------------------
%% Triangular UL : Up left
%% --------------------

    \newcommand{\triangleULdiagram}[6]{
        \begin{tikzpicture}
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5 ex,
                    text depth = 0.25 ex,
                    ampersand replacement = \&] {
                \displaystyle{#1} \& \displaystyle{#2} \\
                \displaystyle{#3} \& \\
            };
            \path [\@diagAA] (m-1-1) edge [\@diagLA] node [above]       {$#4$} (m-1-2);
            \path [\@diagAB] (m-1-1) edge [\@diagLB] node [left]        {$#5$} (m-2-1);
            \path [\@diagAC] (m-2-1) edge [\@diagLC] node [below right] {$#6$} (m-1-2);
        \end{tikzpicture}
    }
    
%% --------------------
%% Triangular UR : Up right
%% --------------------

    \newcommand{\triangleURdiagram}[6]{
        \begin{tikzpicture}
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5ex,
                    text depth = 0.25ex,
                    ampersand replacement = \&] {
                \displaystyle{#1} \& \displaystyle{#2} \\
                \& \displaystyle{#3} \\
            };
            \path [\@diagAA] (m-1-1) edge [\@diagLA] node [above]      {$#4$} (m-1-2);
            \path [\@diagAB] (m-1-1) edge [\@diagLB] node [below left] {$#5$} (m-2-2);
            \path [\@diagAC] (m-1-2) edge [\@diagLC] node [right]      {$#6$} (m-2-2);
        \end{tikzpicture}
    }
    
%% --------------------
%% Triangular DL : Down left
%% --------------------

    \newcommand{\triangleDLdiagram}[6]{
        \begin{tikzpicture}
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5ex,
                    text depth = 0.25ex,
                    ampersand replacement = \&] {
                \displaystyle{#1} \& \\
                \displaystyle{#2} \& \displaystyle{#3} \\
            };
            \path [\@diagAA] (m-1-1) edge [\@diagLA] node [left]        {$#4$} (m-2-1);
            \path [\@diagAB] (m-1-1) edge [\@diagLB] node [above right] {$#5$} (m-2-2);
            \path [\@diagAC] (m-2-1) edge [\@diagLC] node [below]       {$#6$} (m-2-2);
        \end{tikzpicture}
    }
    
%% --------------------
%% Triangular DR : Down right
%% --------------------

    \newcommand{\triangleDRdiagram}[6]{
        \begin{tikzpicture}
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5ex,
                    text depth = 0.25ex,
                    ampersand replacement = \&] {
                \& \displaystyle{#1} \\
                \displaystyle{#2} \& \displaystyle{#3} \\
            };
            \path [\@diagAA] (m-2-1) edge [\@diagLA] node [above left] {$#4$} (m-1-2);
            \path [\@diagAB] (m-1-2) edge [\@diagLB] node [right]      {$#5$} (m-2-2);
            \path [\@diagAC] (m-2-1) edge [\@diagLC] node [above]      {$#6$} (m-2-2);
        \end{tikzpicture}
    }
        
%% --------------------
%% Triangular U : Up
%% --------------------

    \newcommand{\triangleUdiagram}[6]{
        \begin{tikzpicture}
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5ex,
                    text depth = 0.25ex,
                    ampersand replacement = \&] {
                \& \displaystyle{#1} \& \\
                \displaystyle{#2} \& \& \displaystyle{#3} \\
            };
            \path [\@diagAA] (m-1-2) edge [\@diagLA] node [above left]  {$#4$} (m-2-1);
            \path [\@diagAB] (m-1-2) edge [\@diagLB] node [above right] {$#5$} (m-2-3);
            \path [\@diagAC] (m-2-1) edge [\@diagLC] node [above]       {$#6$} (m-2-3);
        \end{tikzpicture}
    }
    
%% --------------------
%% Triangular L : Left
%% --------------------
    \newcommand{\triangleLdiagram}[6]{
        \begin{tikzpicture}
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5ex,
                    text depth = 0.25ex,
                    ampersand replacement = \&] {
                \& \displaystyle{#1} \\
                \displaystyle{#2} \& \\
                \& \displaystyle{#3} \\
            };
            \path [\@diagAA] (m-2-1) edge [\@diagLA] node [above left] {$#4$} (m-1-2);
            \path [\@diagAB] (m-1-2) edge [\@diagLB] node [right]      {$#5$} (m-3-2);
            \path [\@diagAC] (m-2-1) edge [\@diagLC] node [below left] {$#6$} (m-3-2);
        \end{tikzpicture}
    }
        
%% --------------------
%% Triangular R : Right
%% --------------------

    \newcommand{\triangleRdiagram}[6]{
        \begin{tikzpicture}
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5ex,
                    text depth = 0.25ex,
                    ampersand replacement = \&] {
                \displaystyle{#1} \& \\
                \& \displaystyle{#2} \\
                \displaystyle{#3} \& \\
            };
            \path [\@diagAA] (m-1-1) edge [\@diagLA] node [left]        {$#4$} (m-3-1);
            \path [\@diagAB] (m-1-1) edge [\@diagLB] node [above right] {$#5$} (m-2-2);
            \path [\@diagAC] (m-3-1) edge [\@diagLC] node [below right] {$#6$} (m-2-2);
        \end{tikzpicture}
    }
    
%% --------------------
%% Triangular D : Down
%% --------------------

    \newcommand{\triangleDdiagram}[6]{
        \begin{tikzpicture}
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5ex,
                    text depth = 0.25ex,
                    ampersand replacement = \&] {
                \displaystyle{#1} \& \& \displaystyle{#2} \\
                \& \displaystyle{#3} \& \\
            };
            \path [\@diagAA] (m-1-1) edge [\@diagLA] node [above]       {$#4$} (m-1-3);
            \path [\@diagAB] (m-1-1) edge [\@diagLB] node [below left]  {$#5$} (m-2-2);
            \path [\@diagAC] (m-1-3) edge [\@diagLC] node [below right] {$#6$} (m-2-2);
        \end{tikzpicture}
    }
    
%% --------------------
%% Equalizer
%% --------------------
    
    \newcommand{\eqdiagram}[6]{
        \begin{tikzpicture}[inline/.style = {fill = white, inner sep = 2.5pt}]
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5ex,
                    text depth = 0.25ex,
                    ampersand replacement = \&] {
                \displaystyle{#1} \& \displaystyle{#2} \& \displaystyle{#3} \\
            };
            \path [\@diagAA] (m-1-1)                    edge [\@diagLA] node [above] {$#4$} (m-1-2);
            \path [\@diagAB] ($(m-1-2.east) + (0,0.1)$) edge [\@diagLB] node [above] {$#5$} ($(m-1-3.west) + (0,0.1)$);
            \path [\@diagAC] ($(m-1-2.east) - (0,0.1)$) edge [\@diagLC] node [below] {$#6$} ($(m-1-3.west) - (0,0.1)$);
        \end{tikzpicture}
    }
    
%% --------------------
%% Coequalizer
%% --------------------
    
    \newcommand{\coeqdiagram}[6]{
        \begin{tikzpicture}[inline/.style = {fill = white, inner sep = 2.5pt}]
            \matrix (m) [matrix of math nodes,
                    row sep = \@tRowsep em,
                    column sep = \@tColsep em,
                    text height = 1.5ex,
                    text depth = 0.25ex,
                    ampersand replacement = \&] {
                \displaystyle{#1} \& \displaystyle{#2} \& \displaystyle{#3} \\
            };
            \path [\@diagAA] ($(m-1-1.east) + (0,0.1)$) edge [\@diagLA] node [above] {$#4$} ($(m-1-2.west) + (0,0.1)$);
            \path [\@diagAB] ($(m-1-1.east) - (0,0.1)$) edge [\@diagLB] node [below] {$#5$} ($(m-1-2.west) - (0,0.1)$);
            \path [\@diagAC] (m-1-2)                    edge [\@diagLC] node [above] {$#6$} (m-1-3);
        \end{tikzpicture}
    }
    
}{} % \ifthenelse{\boolean{@b_extpack_use_tikz}}{